## SPRING
- 스프링은 자바 언어 기반의 프레임워크
- 자바 언어의 가장 큰 특징은 [객체 지향 언어](https://github.com/SeokHyeMin/TIL/blob/main/JAVA/객체지향.md)이다.
- 스프링은 객체 지향언어가 가진 강력한 특징을 살려내는 프레임워크이다.
- 스프링은 좋은 객체 지향 애플리케이션을 개발할 수 있게 도와주는 프레임워크이다.

#### **스프링과 객체 지향**
- 스프링은 다형성을 극대화해서 이용할 수 있게 도와주기 때문에, 다형성이 가장 중요하다.
- 스프링을 사용하면, 공연무대의 배우를 선택하듯이 구현을 편리하게 변경할 수 있다.
- 제어의 역전(IoC), 의존관계 주입(DI)은 다형성을 활용해서 역할과 구현을 편리하게 다룰 수 있도록 지원한다.
- 스프링은 DI(Dependency Injection)과 DI 컨테이너를 통해서 다형성과 OCP, DIP를 가능하게 지원한다.
- 즉, 클라이언트 코드의 변경 없이 기능을 확장할 수 있다.

#### **IoC, DI, 그리고 컨테이너**
📌 **제어의 역전 IoC(Inversion of Control)**
  - 프로그램의 제어 흐름을 직접 제어하는 것이 아니라 외부에서 관리하는 것을 제어의 역전이라고 한다.

📌 **의존관계 주입 DI(Dependency Injection)**
- 애플리케이션 실행 시점(런타임)에 외부에서 실제 구현 객체를 생성하고 클라이언트에 전달해서 클라이언트와 서버의 실제 의존관계가 연결되는 것을 의존관계 주입이라고 한다.
- 객체 인스턴스를 생성하고, 그 참조값을 전달해서 연결된다.
- 의존관계 주입을 사용하면 클라이언트 코드를 변경하지 않고, 클라이언트가 호출하는 대상의 타입 인스턴스를 변경할 수 있다.
- 의존관계 주입을 사용하면 정적인 클래스 의존관계를 변경하지 않고, 동적인 객체 인스턴스 의존관계를 쉽게 변경할 수 있다.
  - 의존관계는 정적인 클래스 의존관계와 실행 시점에 결정되는 동적인 객체(인스턴스) 의존 관계 둘을 분리해서 생각해야 한다.
  - 동적인 객체 인스턴스 의존관계는 애플리케이션 실행시점에 실제 생성된 객체 인스턴스의 참조가 연결된 의존 관계다.
  
#### 프레임워크와 라이브러리
- 프레임 워크가 내가 작성한 코드를 제어하고 대신 실행하면 이것은 프레임워크가 맞다. (ex: JUnit)
- 반면에 내가 작성한 코드가 직접 제어의 흐름을 담당한다면 그것은 프레임워크가 아니라 라이브러리이다.
<hr>

### 스프링 컨테이너
- 스프링 컨테이너는 @Configuration이 붙은 AppConfig를 설정(구성) 정보로 사용한다. 여기서 @Bean이라 적힌 메서드를 모두 호출해서 반환된 객체를 스프링 컨테이너에 등록한다.
- 이렇게 스프링 컨테이너에 등록된 객체를 스프링 빈이라 한다.
- 스프링 컨테이너는 설정 정보를 참고해서 의존관계를 주입(DI)한다.

### 싱글톤 컨테이너
- 스프링 컨테이너는 싱글톤 패턴의 문제점을 해결하면서, 객체 인스턴스를 싱글톤(1개만 생성)으로 관리한다.
  - 여기서 싱글톤 패턴의 문제점이란?
    - 싱글톤 패턴을 구현하는 코드 자체가 많이 들어가고, 의존관계상 클라이언트가 구체 클래스에 의존하게 되어 DIP를 위반한다.
    - 클라이언트가 구체 클래스에 의존해서 OCP 원칙을 위반할 가능성이 높다.
    - 테스트하기도 어렵고, 내부 속성을 변경하거나 초기화하기 어렵다.
    - private 생성자로 자식클래스를 만들기도 어려워 **결론적으로 유연성이 떨어진다.**
- **스프링 컨테이너는 싱글톤 패턴을 적용하지 않아도, 객체 인스턴스를 싱글톤으로 관리한다.**
#### 📌 참고로 스프링 빈의 필드에 공유 값을 설정하면 큰 장애가 발생할 수도 있으니 스프링 빈은 항상 무상태(stateless)로 설계해야한다!!!!!!
- @Configuration을 적용하면 바이트코드를 조작하는 CGLIB기술을 사용해서 싱글톤을 보장한다.
  - @Bean이 붙은 메서드마다 이미 스프링 빈이 존재하면 존재하는 빈을 반환하고, 스프링 빈이 없으면 생성해서 스프링 빈으로 등록하고 반환하는 코드가 동적으로 만들어진다.
  - 이 덕분에 싱글톤이 보장된다.


